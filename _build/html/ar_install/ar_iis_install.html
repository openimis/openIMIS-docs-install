

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Configure IIS &mdash; openIMIS  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> openIMIS
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../net_install/minimum_requirements.html">Minimum requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../net_install/database_sql_server_installation_guide.html">Database installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../net_install/web_app_vb_installation_guide.html">Web application installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../net_install/web_service_vb_installation_guide.html">Web service installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../net_install/windows_services_installation_guide.html">Windows services installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../net_install/mobile_applications_configuration.html">Mobile application configuration guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">openIMIS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Configure IIS</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ar_install/ar_iis_install.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="configure-iis">
<h1>Configure IIS<a class="headerlink" href="#configure-iis" title="Permalink to this headline">¶</a></h1>
<div class="section" id="additional-configuration-in-microsoft-iis">
<h2>Additional configuration in Microsoft IIS<a class="headerlink" href="#additional-configuration-in-microsoft-iis" title="Permalink to this headline">¶</a></h2>
<p>The default configuration of IIS 8.X is missing components that are necessary for HTTP access to Analysis Services.</p>
<ol class="arabic">
<li><p class="first">Open the Web server role management</p>
<blockquote>
<div><ul class="simple">
<li>Use <em>Server Manager</em> → <em>Manage</em> → <em>Add Roles and Features</em> then step through the wizard until you get to the Server Role* s. Scroll down to find Web Server (IIS).</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Add the roles:</p>
<blockquote>
<div><ul>
<li><p class="first"><em>Web Server</em> → <em>Security</em> → <em>authentication methods</em> → <strong>Windows Authentication</strong>, or <strong>Basic Authentication</strong>, and any other security features required for your data access scenario (<a class="reference internal" href="#security-auth"><span class="std std-ref">Image -  Authentication methods</span></a>)</p>
<blockquote>
<div><div class="figure align-center" id="id1">
<span id="security-auth"></span><img alt="../_images/security_auth.png" src="../_images/security_auth.png" />
<p class="caption"><span class="caption-text"><cite>Image - Authentication methods</cite></span></p>
</div>
</div></blockquote>
</li>
<li><p class="first"><em>Web Server</em> → <em>Application Development</em> → <em>CGI and ISAPI Extensions</em> → <strong>CGI</strong>. (<a class="reference internal" href="#select-iis-feature"><span class="std std-ref">Image -  IIS feature</span></a>)</p>
</li>
<li><p class="first"><em>Web Server</em> → <em>Application Development</em> → <em>CGI and ISAPI Extensions</em> → <strong>ISAPI Extensions</strong>. (<a class="reference internal" href="#select-iis-feature"><span class="std std-ref">Image -  IIS feature</span></a>)</p>
<blockquote>
<div><div class="figure align-center" id="id2">
<span id="select-iis-feature"></span><img alt="../_images/select_iis_feature.png" src="../_images/select_iis_feature.png" />
<p class="caption"><span class="caption-text"><cite>Image - IIS feature</cite></span></p>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="copy-openimis-analytic-and-reporting-services">
<h2>Copy openIMIS Analytic and reporting Services<a class="headerlink" href="#copy-openimis-analytic-and-reporting-services" title="Permalink to this headline">¶</a></h2>
<p>Download and unzip the release from Github ar_imis_reporting_tool  repository
(<a class="reference external" href="https://github.com/openimis/ar_imis_reporting_tool/releases/latest">https://github.com/openimis/ar_imis_reporting_tool/releases/latest</a>) in a new folder (openIMIS.WS.X.Y.Z)
under the IIS wwwroot (usually in C:\inetpub\wwwroot).</p>
</div>
<div class="section" id="copy-the-msmdpump-files-to-a-folder-on-the-web-server">
<h2>Copy the MSMDPUMP files to a folder on the Web server<a class="headerlink" href="#copy-the-msmdpump-files-to-a-folder-on-the-web-server" title="Permalink to this headline">¶</a></h2>
<p>Each HTTP endpoint that you create must have its own set of MSMDPUMP files. In this step, you copy the MSMDPUMP executable, configuration file, and resource folder from the Analysis Services program folders to a new virtual directory folder that you will create on the file system of the computer running IIS.
The drive must be formatted for the NTFS file system. The path to the folder that you create must not contain any spaces.</p>
<ol class="arabic">
<li><p class="first">Copy the following files, found at &lt;drive&gt;:Program Files\Microsoft SQL Server\&lt;instance&gt;\OLAP\bin\isapi: MSMDPUMP.DLL, MSMDPUMP.INI, and a Resources folder. (<a class="reference internal" href="#msmdpump-folder"><span class="std std-ref">Image -  MSMDPUMP folder content</span></a>)</p>
<blockquote>
<div><div class="figure align-center" id="id3">
<span id="msmdpump-folder"></span><img alt="../_images/MSMDPUMP_folder.png" src="../_images/MSMDPUMP_folder.png" />
<p class="caption"><span class="caption-text"><cite>Image - MSMDPUMP folder content</cite></span></p>
</div>
</div></blockquote>
</li>
<li><p class="first">On the web server, create a new folder: <em>&lt;drive&gt;:\inetpub\wwwroot\datawarehouse</em></p>
</li>
<li><p class="first">Paste the files that you previously copied into this new folder.</p>
</li>
<li><p class="first">Verify that the <em>\inetpub\wwwroot\OLAP</em> folder on your web server contains the following: <em>MSMDPUMP.DLL</em>, <em>MSMDPUMP.INI</em>, and a <em>Resources</em> folder. Your folder structure should look like this:</p>
<blockquote>
<div><ul class="simple">
<li><em>&lt;drive&gt;:\inetpub\wwwroot\OLAP\MSMDPUMP.dll</em></li>
<li><em>&lt;drive&gt;:\inetpub\wwwroot\OLAP\MSMDPUMP.ini</em></li>
<li><em>&lt;drive&gt;:\inetpub\wwwroot\OLAP\Resources</em></li>
</ul>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="create-an-application-pool-in-iis">
<h2>Create an application pool in IIS<a class="headerlink" href="#create-an-application-pool-in-iis" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Start IIS Manager</li>
<li>Create OLAP application pool</li>
</ol>
<blockquote>
<div><dl class="docutils">
<dt>Open the server folder, then right-click <em>Application Pools</em> → <strong>Add Application Pool</strong>.</dt>
<dd><ul class="first simple">
<li>Name the new application pool <em>OLAP</em> (<a class="reference internal" href="#olap-pool"><span class="std std-ref">Image -  OLAP application pool configuration</span></a>)</li>
<li><em>.NET CLR version” set to *.NET CLR version v4.x</em>,</li>
<li><em>Managed pipeline mode</em> set to <em>classic</em>.</li>
</ul>
<div class="last figure align-center" id="id4">
<span id="olap-pool"></span><img alt="../_images/OLAP_pool.png" src="../_images/OLAP_pool.png" />
<p class="caption"><span class="caption-text"><cite>Image - OLAP application pool configuration</cite></span></p>
</div>
</dd>
</dl>
</div></blockquote>
<ol class="arabic simple">
<li>By default, IIS creates application pools using ApplicationPoolIdentity as the security identity, which is a valid choice for HTTP access to Analysis Services.</li>
</ol>
</div>
<div class="section" id="create-an-virtual-directory-in-iis">
<h2>Create an virtual directory in IIS<a class="headerlink" href="#create-an-virtual-directory-in-iis" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">In IIS Manager, open Sites, open Default Web Site. You should see a folder named Datawarehouse. This is a reference to the datawarehouse folder you created under \inetpub\wwwroot.(<a class="reference internal" href="#dw-site"><span class="std std-ref">Image -  Datawarehouse site tree structure</span></a>)</p>
<blockquote>
<div><div class="figure align-center" id="id5">
<span id="dw-site"></span><img alt="../_images/dw_site.png" src="../_images/dw_site.png" />
<p class="caption"><span class="caption-text"><cite>Image - Datawarehouse site tree structure</cite></span></p>
</div>
</div></blockquote>
</li>
<li><p class="first">Right-click on the Project IMIS (Phase 1) and then add Application</p>
</li>
<li><p class="first">In Add Application, enter Datawarehouse for the alias. Click Select to choose the Datawarehouse application pool. Physical Path should be set to &lt;drive&gt;:\inetpub\wwwroot\ Datawarehouse(<a class="reference internal" href="#dw-application"><span class="std std-ref">Image -  ADD application on the datawarehouse site</span></a>)</p>
<blockquote>
<div><div class="figure align-center" id="id6">
<span id="dw-application"></span><img alt="../_images/dw_application.png" src="../_images/dw_application.png" />
<p class="caption"><span class="caption-text"><cite>Image - ADD application on the datawarehouse site</cite></span></p>
</div>
</div></blockquote>
</li>
<li><p class="first">Click <strong>OK</strong>. Refresh the web site and notice that the IMIS (PHASE 1) folder is now an application under the default web site. The virtual path to the MSMDPUMP file is now established.(<a class="reference internal" href="#dw-folder-in-app-folder"><span class="std std-ref">Image -  New application in datawarehouse site tree structure</span></a>)</p>
<blockquote>
<div><div class="figure align-center" id="id7">
<span id="dw-folder-in-app-folder"></span><img alt="../_images/dw_folder_in_app_folder.png" src="../_images/dw_folder_in_app_folder.png" />
<p class="caption"><span class="caption-text"><cite>Image - New application in datawarehouse site tree structure</cite></span></p>
</div>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="configure-iis-authentication-and-add-the-extension">
<h2>Configure IIS authentication and add the extension<a class="headerlink" href="#configure-iis-authentication-and-add-the-extension" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>In this step, you further configure the <em>SSAS virtual directory</em> you just created. You will specify an authentication method and then add a script map. Supported authentication methods for Analysis Services over HTTP include:</dt>
<dd><ul class="first last simple">
<li>Windows authentication (Kerberos or NTLM)</li>
<li>Basic authentication</li>
</ul>
</dd>
</dl>
<p>In this case we will use <em>Basic authentication</em>, make sure that the <em>Basic authentication</em> is checked in IIS features as as described in <a href="#id10"><span class="problematic" id="id11">`additional_configuration_in_microsoft_iis&gt;`__</span></a>.</p>
<p><strong>Basic authentication</strong> is used when you have Windows identities, but user connections are from non-trusted domains (if your client and server applications are in different domains), prohibiting the use of delegated or impersonated connections. <em>Basic authentication</em> lets you specify a user identity and password on a connection string. Instead of using the security context of the current user, credentials on the connection string are used to connect to Analysis Services. Because Analysis Services supports only Windows authentication, any credentials passed to it must be a Windows user or group that is a member of the domain in which Analysis Services is hosted.</p>
<p>This mode requires the user to enter a user name and password. The user name and password are transmitted over the HTTP connection to IIS. IIS will try to impersonate the user using the provided credentials when connecting to MSMDPUMP, but the credentials will not be delegated to Analysis Services. Instead, you will need to pass a valid user name and password on a connection, as described in Step 6 in this document.</p>
<p><em>Please note that it is imperative for anyone building a system where the password is transmitted to have ways of securing the communication channel. IIS provides a set of tools that help you secure the channel.</em></p>
<p><strong>Set the authentication type</strong></p>
<ol class="arabic">
<li><p class="first">In IIS Manager, open sites, open Default Web Site, and then select the datawarehouse virtual directory.(<a class="reference internal" href="#iis-auth"><span class="std std-ref">Image - IIS configuration panel</span></a>)</p>
<blockquote>
<div><div class="figure align-center" id="id8">
<span id="iis-auth"></span><img alt="../_images/IIS_auth.png" src="../_images/IIS_auth.png" />
<p class="caption"><span class="caption-text"><cite>Image - IIS configuration panel</cite></span></p>
</div>
</div></blockquote>
</li>
<li><p class="first">Double-click Authentication in the IIS section of the main page.(<a class="reference internal" href="#iis-auth-details"><span class="std std-ref">Image - IIS Authentication configuration</span></a>)</p>
<blockquote>
<div><div class="figure align-center" id="id9">
<span id="iis-auth-details"></span><img alt="../_images/IIS_auth_details.png" src="../_images/IIS_auth_details.png" />
<p class="caption"><span class="caption-text"><cite>Image - IIS Authentication configuration</cite></span></p>
</div>
</div></blockquote>
</li>
<li><dl class="first docutils">
<dt>Disable Anonymous Authentication if you are using Windows or Basic authentication. When Anonymous authentication is enabled, IIS will always use it first, even if other authentication methods are enabled.</dt>
<dd><ul class="first last">
<li><p class="first">Click the datawarehouse virtual directory to open the main page. Double-click Handler Mappings.(<a class="reference internal" href="#iis-handler-mappings"><span class="std std-ref">Image - IIS configuration panel</span></a>)</p>
<blockquote>
<div><div class="figure align-center" id="iis-handler-mappings">
<img alt="../_images/IIS_handler_mappings.png" src="../_images/IIS_handler_mappings.png" />
</div>
<p><cite>Image - IIS configuration panel</cite></p>
</div></blockquote>
</li>
<li><p class="first">Right-click anywhere on the page and then select Add Script Map. In the Add Script Map dialog box, specify \*.dll as the request path, specify <em>&lt;drive&gt;:\inetpub\wwwroot\OLAP\msmdpump.dll</em> as the executable, and type datawarehouse as the name. Keep all of the default restrictions associated with this script map.(<a class="reference internal" href="#iis-handler-mappings-details"><span class="std std-ref">Image - IIS handler mappings</span></a>)</p>
<blockquote>
<div><div class="figure align-center" id="iis-handler-mappings-details">
<img alt="../_images/IIS_handler_mappings_details.png" src="../_images/IIS_handler_mappings_details.png" />
</div>
<p><cite>Image - IIS handler mappings</cite></p>
</div></blockquote>
</li>
<li><p class="first">When prompted to allow the ISAPI extension, click Yes.(<a class="reference internal" href="#iis-handler-mappings-popup"><span class="std std-ref">Image - IIS handler mappings confirmation pop-up</span></a>)</p>
<blockquote>
<div><div class="figure align-center" id="iis-handler-mappings-popup">
<img alt="../_images/IIS_handler_mappings_popup.png" src="../_images/IIS_handler_mappings_popup.png" />
</div>
<p><cite>Image - IIS handler mappings confirmation pop-up</cite></p>
</div></blockquote>
</li>
</ul>
</dd>
</dl>
</li>
</ol>
</div>
<div class="section" id="edit-the-msmdpump-ini-file-to-set-the-target-server">
<h2>Edit the MSMDPUMP.INI file to set the target server<a class="headerlink" href="#edit-the-msmdpump-ini-file-to-set-the-target-server" title="Permalink to this headline">¶</a></h2>
<p>The <em>MSMDPUMP.INI</em> file specifies the Analysis Services instance that <em>MSMDPUMP.DLL</em> connects to. This instance can be local or remote, installed as the default or as a named instance.
Open the <em>msmdpump.ini</em> file located in folder &lt;drive&gt;:\inetpub\wwwroot\datawarehouse and take a look at the contents of this file. It should look like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">ConfigurationSettings</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">ServerName</span><span class="o">&gt;</span><span class="n">localhost</span><span class="o">&lt;/</span><span class="n">ServerName</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">SessionTimeout</span><span class="o">&gt;</span><span class="mi">3600</span><span class="o">&lt;/</span><span class="n">SessionTimeout</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">ConnectionPoolSize</span><span class="o">&gt;</span><span class="mi">100</span><span class="o">&lt;/</span><span class="n">ConnectionPoolSize</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">ConfigurationSettings</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>If the Analysis Services instance for which you are configuring HTTP access is located on the local computer and installed as a default instance, there is no reason to change this setting. Otherwise, you must specify the server name (for example, <code class="docutils literal notranslate"><span class="pre">&lt;ServerName&gt;</span> <span class="pre">EXACT-SRV01&lt;/ServerName&gt;</span></code>). For a server that is installed as a named instance, be sure to append the instance name (for example, <code class="docutils literal notranslate"><span class="pre">&lt;ServerName&gt;</span> <span class="pre">EXACT-SRV01\\Tabular&lt;/ServerName&gt;</span></code>).</p>
<p>By default, Analysis Services listens on TCP/IP port 2383. If you installed Analysis Services as the default instance, you do not need to specify any port in <code class="docutils literal notranslate"><span class="pre">&lt;ServerName&gt;</span></code> because Analysis Services knows how to listen on port 2383 automatically. However, you do need to allow inbound connections to that port in Windows Firewall.</p>
<p>If you configured a named or default instance of Analysis Services to listen on a fixed port, you must add the port number to the server name (for example, <code class="docutils literal notranslate"><span class="pre">&lt;ServerName&gt;</span> <span class="pre">EXACT-SRV01:55555&lt;/ServerName&gt;</span></code>) and you must allow inbound connections in Windows Firewall to that port.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, openIMIS team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>